name: Fetch Live Channels and Create JSON

on:
  schedule:
    - cron: '0 * * * *'   # تشغيل كل ساعة (يمكن تعديله حسب الحاجة)
  workflow_dispatch:

jobs:
  fetch-channels:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4  # تحديث إلى الإصدار الأحدث

      - name: Setup Node.js environment
        uses: actions/setup-node@v4  # تحديث إلى الإصدار الأحدث
        with:
          node-version: '20'

      - name: Install dependencies
        run: npm install

      - name: Run fetchChannels script
        run: node fetchChannels.js

      # ✅ تحديث إلى `actions/upload-artifact@v4` بدلاً من الإصدار القديم
      - name: Upload channels.json artifact
        uses: actions/upload-artifact@v4
        with:
          name: channels-json
          path: channels.json
